<!DOCTYPE html>
<meta charset="utf-8">
<style>

.counties {
  fill: none;
}

.cd113 {
  fill: none;
  stroke: #606060;
  stroke-linejoin: round;
}

/*
.q0-9 { fill:rgb(247,251,255); }
.q1-9 { fill:rgb(222,235,247); }
.q2-9 { fill:rgb(198,219,239); }
.q3-9 { fill:rgb(158,202,225); }
.q4-9 { fill:rgb(107,174,214); }
.q5-9 { fill:rgb(66,146,198); }
.q6-9 { fill:rgb(33,113,181); }
.q7-9 { fill:rgb(8,81,156); }
.q8-9 { fill:rgb(8,48,107); }
*/
/*
.q0-9 { fill:#E9BABA; }
.q1-9 { fill:#D9A9A9; }
.q2-9 { fill:#BA8989; }
.q3-9 { fill:#AB7979; }
.q4-9 { fill:#8C5858; }
.q5-9 { fill:#7C4848; }
.q6-9 { fill:#6D3838; }
.q7-9 { fill:#5D2828; }
.q8-9 { fill:#4E1818; }
*/
/*
.q0-9 { fill:#D3F7CE; }
.q1-9 { fill:#BAE0B5; }
.q2-9 { fill:#A2CA9C; }
.q3-9 { fill:#89B384; }
.q4-9 { fill:#719D6B; }
.q5-9 { fill:#588652; }
.q6-9 { fill:#40703A; }
.q7-9 { fill:#275921; }
.q8-9 { fill:#0F4309; }
*/

.q0-9 { fill:#517eff; }
.q1-9 { fill:#52d0ff; }
.q2-9 { fill:#53ffdc; }
.q3-9 { fill:#53ff8c; }
.q4-9 { fill:#6bff54; }
.q5-9 { fill:#bbff55; }
.q6-9 { fill:#fff255; }
.q7-9 { fill:#ffa356; }
.q8-9 { fill:#ff5758; }

</style>
<body>
<script src="d3.v3.min.js"></script>
<script src="queue.v1.min.js"></script>
<script src="topojson.v1.min.js"></script>
<script>

var width = 1920,
    height = 1080;

var rateById = d3.map();

var quantize = d3.scale.quantize()
    .domain([0, 600])
    .range(d3.range(9).map(function(i) { return "q" + i + "-9"; }));

var projection = d3.geo.albersUsa()
    .scale(2200)
    .translate([width / 2, height / 2]);

var path = d3.geo.path()
    .projection(projection);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

queue()
    .defer(d3.json, "us-congress-113.json")
    .defer(d3.tsv, "members.tsv", function(d) { rateById.set(d.id, +d.rate); })
    .await(ready);

function ready(error, us) {
  if (error) throw error;

  svg.append("g")
      .attr("class", "cd113")
    .selectAll("path")
      .data(topojson.feature(us, us.objects.cd113).features)
    .enter().append("path")
      .attr("class", function(d) { return quantize(rateById.get(d.id)); })
      .attr("d", path);

/*
  svg.append("path")
      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
      .attr("class", "states")
      .attr("d", path);
      */

  svg.append("text")
        .attr("x", (width / 2))
        .attr("y", 75)
        .attr("text-anchor", "middle")
        .style("text-decoration", "underline")
        .style("font-size", "48px")
        .text("NWYC Members by Congressional District Fall 2015");

  svg.append("line")
        .attr("x1", 1550)
        .attr("y1", 750)
        .attr("x2", 1550)
        .attr("y2", 1075)
        .attr("stroke-width", 1)
        .attr("stroke", "black");

  svg.append("line")
        .attr("x1", 1550)
        .attr("y1", 1075)
        .attr("x2", 1725)
        .attr("y2", 1075)
        .attr("stroke-width", 1)
        .attr("stroke", "black");

  svg.append("line")
        .attr("x1", 1725)
        .attr("y1", 1075)
        .attr("x2", 1725)
        .attr("y2", 750)
        .attr("stroke-width", 1)
        .attr("stroke", "black");

  svg.append("line")
        .attr("x1", 1725)
        .attr("y1", 750)
        .attr("x2", 1550)
        .attr("y2", 750)
        .attr("stroke-width", 1)
        .attr("stroke", "black");

  svg.append("rect")
        .attr("x", 1560)
        .attr("y", 760)
        .attr("width", 25)
        .attr("height", 25)
        .attr("fill", "#517eff")
        .attr("stroke-width", .5)
        .attr("stroke", "black");

  svg.append("rect")
        .attr("x", 1560)
        .attr("y", 795)
        .attr("width", 25)
        .attr("height", 25)
        .attr("fill", "#52d0ff")
        .attr("stroke-width", .5)
        .attr("stroke", "black");

  svg.append("rect")
        .attr("x", 1560)
        .attr("y", 830)
        .attr("width", 25)
        .attr("height", 25)
        .attr("fill", "#53ffdc")
        .attr("stroke-width", .5)
        .attr("stroke", "black");

  svg.append("rect")
        .attr("x", 1560)
        .attr("y", 865)
        .attr("width", 25)
        .attr("height", 25)
        .attr("fill", "#53ff8c")
        .attr("stroke-width", .5)
        .attr("stroke", "black");

  svg.append("rect")
        .attr("x", 1560)
        .attr("y", 900)
        .attr("width", 25)
        .attr("height", 25)
        .attr("fill", "#6bff54")
        .attr("stroke-width", .5)
        .attr("stroke", "black");

  svg.append("rect")
        .attr("x", 1560)
        .attr("y", 935)
        .attr("width", 25)
        .attr("height", 25)
        .attr("fill", "#bbff55")
        .attr("stroke-width", .5)
        .attr("stroke", "black");

  svg.append("rect")
        .attr("x", 1560)
        .attr("y", 970)
        .attr("width", 25)
        .attr("height", 25)
        .attr("fill", "#fff255")
        .attr("stroke-width", .5)
        .attr("stroke", "black");

  svg.append("rect")
        .attr("x", 1560)
        .attr("y", 1005)
        .attr("width", 25)
        .attr("height", 25)
        .attr("fill", "#ffa356")
        .attr("stroke-width", .5)
        .attr("stroke", "black");

  svg.append("rect")
        .attr("x", 1560)
        .attr("y", 1040)
        .attr("width", 25)
        .attr("height", 25)
        .attr("fill", "#ff5758")
        .attr("stroke-width", .5)
        .attr("stroke", "black");

  svg.append("text")
        .attr("x", 1590)
        .attr("y", 778)
        .style("font-size", "16px")
        .text("0-100 Members");

  svg.append("text")
        .attr("x", 1590)
        .attr("y", 813)
        .style("font-size", "16px")
        .text("100-149");

  svg.append("text")
        .attr("x", 1590)
        .attr("y", 848)
        .style("font-size", "16px")
        .text("150-199");

  svg.append("text")
        .attr("x", 1590)
        .attr("y", 883)
        .style("font-size", "16px")
        .text("200-249");
        
  svg.append("text")
        .attr("x", 1590)
        .attr("y", 918)
        .style("font-size", "16px")
        .text("250-299");

  svg.append("text")
        .attr("x", 1590)
        .attr("y", 953)
        .style("font-size", "16px")
        .text("300-349");

  svg.append("text")
        .attr("x", 1590)
        .attr("y", 988)
        .style("font-size", "16px")
        .text("350-399");

  svg.append("text")
        .attr("x", 1590)
        .attr("y", 1023)
        .style("font-size", "16px")
        .text("400-549");

  svg.append("text")
        .attr("x", 1590)
        .attr("y", 1058)
        .style("font-size", "16px")
        .text("550+");

        d3.json("uk.json", function(error, uk) {
      places = topojson.feature(uk, uk.objects.places);

  svg.append("path")
      .datum(places)
      .attr("d", path)
      .attr("class", "place");

  svg.selectAll(".place-label")
      .data(places.features)
    .enter().append("text")
    .style("font-size", "12px")
      .attr("class", "place-label")
      .attr("transform", function(d) { return "translate(" + projection(d.geometry.coordinates) + ")"; })
      .attr("x", function(d) { return d.geometry.coordinates[0] > -1 ? 6 : -6; })
      .attr("dy", ".35em")
      .style("text-anchor", function(d) { return d.geometry.coordinates[0] > -1 ? "start" : "end"; })
      .text(function(d) { return d.properties.name; });
});

}




d3.select(self.frameElement).style("height", height + "px");

</script>